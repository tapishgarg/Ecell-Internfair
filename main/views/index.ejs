<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<title>InternFair</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="">
	<meta name="keywords" content="">
	<meta name="author" content="CreativeLayers">
	<meta name="google-signin-client_id" content="869757478663-gnlmvb29d5mduo26mrq595svsojrgsus.apps.googleusercontent.com">

	<!-- Styles -->
	<link rel="stylesheet" type="text/css" href="/jobhunt/css/bootstrap-grid.css" />
	<link rel="stylesheet" href="/jobhunt/css/icons.css">
	<link rel="stylesheet" href="/jobhunt/css/animate.min.css">
	<link rel="stylesheet" type="text/css" href="/jobhunt/css/style.css" />
	<link rel="stylesheet" type="text/css" href="/jobhunt/css/responsive.css" />
	<link rel="stylesheet" type="text/css" href="/jobhunt//chosen.css" />
	<link rel="stylesheet" type="text/css" href="/jobhunt/css/colors/colors.css" />
	<link rel="stylesheet" type="text/css" href="/jobhunt//bootstrap.css" />
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" />

</head>
<body>

<div class="page-loading">
	<img src="/jobhunt/images/loader.gif" alt="" />
<!-- 	<span>Skip Loader</span>
 --></div>

<!-- MENU -->
 <% include navbar.ejs %>
<!-- MENU -->

<% include login.ejs %>


<% include signup.ejs %>


<script src="https://apis.google.com/js/platform.js" async defer></script>
<script src="/jobhunt/js/jquery.min.js" type="text/javascript"></script>
<script src="/jobhunt/js/modernizr.js" type="text/javascript"></script>
<script src="/jobhunt/js/script.js" type="text/javascript"></script>
<script src="/jobhunt/js/bootstrap.min.js" type="text/javascript"></script>
<script src="/jobhunt/js/wow.min.js" type="text/javascript"></script>
<script src="/jobhunt/js/slick.min.js" type="text/javascript"></script>
<script src="/jobhunt/js/parallax.js" type="text/javascript"></script>
<script src="/jobhunt/js/select-chosen.js" type="text/javascript"></script>
<script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script>
<script>
    function onSignIn(googleUser) {
        let profile = googleUser.getBasicProfile();
        let user_details = {
            is_signed_in: true,
            name: profile.getName(),
            image_url: profile.getImageUrl(),
            email: profile.getEmail()
        };
        Cookies.set('user_details', JSON.stringify(user_details));
        let reqBody = {
            id_token: googleUser.getAuthResponse().id_token,
        };
        axios.post('/sign_in', reqBody)
            .then(function (response) {
                if (response.data.data !== undefined) {
                    Cookies.set('auth_details', JSON.stringify(response.data.data.insert_joey_user.returning[0]));
                    let reqBody = {
                        query_string: 'mutation {\n' +
                            '  insert_user_detail(objects: [{name: "' + profile.getName() + '", email: "' + profile.getEmail() + '", image_url: "' + profile.getImageUrl() + '", user_h_id: "' + response.data.data.insert_joey_user.returning[0].h_id + '"}], on_conflict: {constraint: user_detail_user_h_id_key, update_columns: [name, email, image_url]}) {\n' +
                            '    affected_rows\n' +
                            '  }\n' +
                            '}'
                    };
                    axios.post('/user', reqBody)
                        .then(function (response) {
                            if (response.data.data !== undefined) {
                            } else {
                            }
                        })
                        .catch(function (error) {
                            console.log(error);
                        });
                } else {
                    console.log(response.data);
                }
            })
            .catch(function (error) {
                console.log(error);
            });
    }
    function signOut() {
        Cookies.remove('user_details');
        Cookies.remove('auth_details');
        let auth2 = gapi.auth2.getAuthInstance();
        auth2.signOut().then(function () {
            my_navbar.user_details.is_signed_in = false;
        });
        location.reload();
    }
</script>

</body>
</html>

